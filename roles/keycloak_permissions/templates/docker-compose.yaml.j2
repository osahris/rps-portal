---
version: "3.4"

networks:
  proxy:
    external: true
  keycloak-internal:

volumes:
  postgres:

services:  
  keycloak_sync:
    image: {{ keycloak_sync_container_image }}:{{ keycloak_sync_container_version }}
    restart: unless-stopped
    networks:
      - keycloak-internal
      - proxy
    #profiles:
    #  - full
    #  - only-rps-sync
    volumes:
      - ./config.yaml:/opt/rps-admin-tools/config.yaml:ro
    entrypoint: ''
    environment:
      - SLEEP_MINUTES=1
    command: /opt/rps-admin-tools/command_loop.sh -c /opt/rps-admin-tools/config.yaml sync permissions
    # --verbose broken because of click_cli and the use of colours in the output, starting without it
