---
- name: install git # we need to fetch the theme
  apt:
    name: git
    state: present

- name: fetch keycloak theme
  git:
    repo: "{{ keycloak_theme }}"
    dest: "{{ remote_path }}/themes/ansible-theme"
    version: master
    force: true
  register: theme
  when: keycloak_theme is defined
# - name: keycloak auto account theme directory
#   file:
#     path: /var/lib/keycloak/themes/auto/account
#     state: directory

# - name: keycloak auto theme account properties
#   template:
#     src: theme.properties.j2
#     dest: /var/lib/keycloak/themes/auto/account/theme.properties

# - name: keycloak auto email theme directory
#   file:
#     path: /var/lib/keycloak/themes/auto/email
#     state: directory

# - name: keycloak auto theme email properties
#   template:
#     src: theme.properties.j2
#     dest: /var/lib/keycloak/themes/auto/email/theme.properties

- name: keycloak auto login theme directory
  file:
    path: /var/lib/keycloak/themes/auto/login
    state: directory

- name: keycloak auto theme login properties
  template:
    src: theme.properties.j2
    dest: /var/lib/keycloak/themes/auto/login/theme.properties

- name: keycloak auto theme registration page
  template:
    src: register.ftl.j2
    dest: /var/lib/keycloak/themes/auto/login/register.ftl
