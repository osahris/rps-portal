---
wordpress_secrets:
  wordpress_draft_admin_password: "{{ wordpress_draft_admin_password | default(lookup('ansible.builtin.password', '/dev/null length=32 chars=ascii_letters,digits')) }}"
  wordpress_draft_mysql_password: "{{ wordpress_draft_mysql_password | default(lookup('ansible.builtin.password', '/dev/null length=32 chars=ascii_letters,digits')) }}"
  wordpress_draft_mysql_root_password: "{{ wordpress_draft_mysql_root_password | default(lookup('ansible.builtin.password', '/dev/null length=32 chars=ascii_letters,digits')) }}"
  wordpress_live_admin_password: "{{ wordpress_live_admin_password | default(lookup('ansible.builtin.password', '/dev/null length=32 chars=ascii_letters,digits')) }}"
  wordpress_live_mysql_password: "{{ wordpress_live_mysql_password | default(lookup('ansible.builtin.password', '/dev/null length=32 chars=ascii_letters,digits')) }}"
  wordpress_live_mysql_root_password: "{{ wordpress_live_mysql_root_password | default(lookup('ansible.builtin.password', '/dev/null length=32 chars=ascii_letters,digits')) }}"

wordpress_live_traefik_dynamic_config:
  http:
    routers:
      wordpress_live:
        rule: "Host(`{{wordpress_live_service_name}}`)"
        entrypoints: websecure
        middlewares: 
          - header-redirect
        service: wordpress_live
        tls:
          certresolver: letsencrypt
    services:
      wordpress_live:
        loadBalancer:
          servers:
            - url: "http://{{wordpress_live_service_name|replace('.', '')}}_wordpress_1"

wordpress_draft_traefik_dynamic_config:
  http:
    routers:
      wordpress_draft:
        rule: "Host(`{{wordpress_draft_service_name}}`)"
        entrypoints: websecure
        middlewares: 
          - header-redirect
          - oauth2-auth
        service: wordpress_draft
        tls:
          certresolver: letsencrypt
    services:
      wordpress_draft:
        loadBalancer:
          servers:
            - url: "http://{{wordpress_draft_service_name|replace('.', '')}}_wordpress_1"
