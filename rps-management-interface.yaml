---

- hosts: reverse_proxies
  remote_user: root
  roles:
    - role: reverse_proxy
      reverse_proxy_for_hosts: "{{ groups.rps_management_interface_servers }}"

- hosts: rps_management_interface_servers
  remote_user: root
  roles:
    - role: rps-management-interface
  tasks:
    - name: write project config file
      copy:
        content: "{{client_config|to_json}}"
        dest: /var/www/rps-management-interface/backend_interface/user_interface/configs/config.{{project_name}}.yaml
    - name: remove test config file
      file:
        path: /var/www/rps-management-interface/backend_interface/user_interface/configs/config.example.yaml
        state: absent
