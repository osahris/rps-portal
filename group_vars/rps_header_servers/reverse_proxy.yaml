---
reverse_proxy_server_name: "{{rps_header_server_name}}"
reverse_proxy_nginx_vhost_custom: |
  add_header 'Access-Control-Allow-Origin' 'https://dt-hub.dzif.de' always;
  add_header 'Access-Control-Allow-Credentials' 'true' always;
  add_header 'Access-Control-Allow-Methods' 'GET, OPTIONS' always;
  add_header 'Access-Control-Allow-Headers' 'access-control-allow-origin' always;
  location /oauth2 {
    proxy_pass http://{{inventory_hostname}}:4180;
    proxy_set_header Host $http_host;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Port $server_port;
    proxy_buffer_size          128k;
    proxy_buffers              4 256k;
    proxy_busy_buffers_size    256k;
  }
  location / {
    proxy_pass http://{{inventory_hostname}}:80;
    proxy_set_header Host $http_host;
    proxy_set_header X-Forwarded-For $remote_addr;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Port $server_port;
    proxy_buffer_size          128k;
    proxy_buffers              4 256k;
    proxy_busy_buffers_size    256k;
  }
  if ($request_method = 'OPTIONS') {
    return 204;
  }
